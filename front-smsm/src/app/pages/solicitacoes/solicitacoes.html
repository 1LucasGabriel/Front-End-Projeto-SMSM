<main>
    <aside class="header">
        <h1 (click)="irPara(['/home'])">HealthFlow</h1>
    </aside>

    <div class="principal">
        <section class="menu">
            <div (click)="irPara(['/home'])">
                <i class="fa-solid fa-house"></i>
                <p>Home</p>
            </div>

            @if (perfil === '1' || perfil === '2') {
                <div (click)="irPara(['/triagem'])">
                    <i class="fa-solid fa-address-card"></i>
                    <p>Triagem</p>
                </div>
            }

            @if (perfil === '1') {
                <div (click)="irPara(['/dashboards'])">
                    <i class="fa-solid fa-chart-pie"></i>
                    <p>Dashboards</p>
                </div>
            }

            @if (perfil === '1' || perfil === '2') {
                <div class="selecionado" (click)="irPara(['/solicitacoes'])">
                    <i class="fa-solid fa-envelope"></i>
                    <p>Solicitar</p>
                </div>
            }

            @if (perfil === '1') {
                <div (click)="irPara(['/lista-demandas'])">
                    <i class="fa-solid fa-list"></i>
                    <p>Demandas</p>
                </div>
            }

            @if (perfil === '1') {
                <div (click)="irPara(['/vagas'])">
                    <i class="fa-solid fa-file"></i>
                    <p>Vagas</p>
                </div>
            }

            <div (click)="sair()">
                <i class="fa-solid fa-right-from-bracket"></i>
                <p>Sair</p>
            </div>
        </section>

        <section class="conteudo">
            <article>
                <h1>Olá, {{nomeUsuario}}!</h1>

                <p>{{data}}</p>
            </article>

            <h2>Nova Solicitação de Procedimento</h2>

            <div class="linha" #container>
                <label>Paciente</label>
                <div class="search-bar">
                    <i class="fa-solid fa-magnifying-glass"></i>
                    <input type="text" placeholder="Pesquise por aqui..." [(ngModel)]="searchTerm" (input)="filtrarPacientes()">
                    <ul *ngIf="sugestoes.length > 0" class="autocomplete-list">
                        <li *ngFor="let p of sugestoes" (click)="selecionarPaciente(p)">
                            {{ p.nome }} - {{ p.cns }}
                        </li>
                    </ul>
                </div>
            </div>

            @if (pacienteSelecionado?.nome) {
                <div class="linha-unica">
                    <p><strong>Nome:</strong> {{pacienteSelecionado?.nome}}</p>
                    <p><strong>Data de Nascimento: </strong>{{pacienteSelecionado?.dataNascimento | date:'dd/MM/yyyy'}}</p>
                </div>
            }

            <div class="linha">
                <label>Procedimento</label>
                <div class="search-bar">
                    <i class="fa-solid fa-magnifying-glass"></i>
                    <input type="text" placeholder="Pesquise por aqui..." [(ngModel)]="searchTermProcedimento" (input)="filtrarProcedimentos()">
                    <ul *ngIf="sugestoesProcedimento.length > 0" class="autocomplete-list">
                        <li *ngFor="let p of sugestoesProcedimento" (click)="selecionarProcedimento(p)">
                            {{ p.nomeProcedimento }} - {{ p.codigoProcedimento }}
                        </li>
                    </ul>
                </div>

                @if (procedimentoSelecionado?.nomeProcedimento) {
                    <p><strong>Procedimento:</strong> {{procedimentoSelecionado?.nomeProcedimento}} - {{procedimentoSelecionado?.codigoProcedimento}}</p>
                }
            </div>

            <div class="grupo">
                <div class="linha">
                    <label>Prioridade</label>
                    <div class="opcoes">
                        <input class="checkbox" type="checkbox" id="baixa" [checked]="solicitacao.prioridade === 'Baixa'" (change)="selecionarPrioridade('Baixa', $event)">Baixa
                        <input class="checkbox"  type="checkbox" id="normal" [checked]="solicitacao.prioridade === 'Normal'" (change)="selecionarPrioridade('Normal', $event)">Normal
                        <input class="checkbox" type="checkbox" id="alta" [checked]="solicitacao.prioridade === 'Alta'" (change)="selecionarPrioridade('Alta', $event)">Alta
                    </div>

                </div>
            </div>

            <div class="linha">
                <label>Justificativa Clínica (Obrigatória)</label>
                <textarea name="justificativa" id="justificativa" [(ngModel)]="solicitacao.justificativa"></textarea>
            </div>

            <button (click)="enviarSolicitacao()">Enviar Solicitação</button>
        </section>  
    </div>
</main>